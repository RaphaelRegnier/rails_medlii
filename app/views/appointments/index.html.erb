<div class="background" style="background-image: url('<%= image_path "blue_background.jpg" %>');"> </div>
<div class="container conversation-form margin-top">
  <div class="row margin-left-new">
    <div class="col-xs-12">
      <h2 class="margin-top">MY<h2>
      <h2 class="margin-shrink">APPOINTMENTS</h2>

      <div class = "text-center list-unstyled">
      <% current_user.appointments.each do |appointment| %>
        <ul>
        <li>
          <% if appointment.other_user.photo.nil? %>
            <% avatar_url = appointment.other_user.facebook_picture_url || "http://placehold.it/30x30" %>
            <% else %>
            <% avatar_url = appointment.other_user.facebook_picture_url || cl_image_path(appointment.other_user.photo.path) || "http://placehold.it/30x30" %>
          <% end %>
          <div class = "avatar-large" style=" background-image: url('<%=avatar_url %>');"></div>
        </li>
        <li> Player: <%= appointment.other_user.first_name %></li>
        <li> Where we will meet: <%= appointment.address %></li>
        <li> When: <%= appointment.date %></li>
        </ul>
      <% end %>

      <div>
      <%= link_to 'Back', users_path, class: 'conv-link' %>
      </div>
      </div>
  </div>
  </div>
</div>

<% content_for(:after_js) do %>
    <%= javascript_tag do %>
      $(document).ready(function() {
        var handler = Gmaps.build('Google');
        handler.buildMap({ internal: { id: 'map' } }, function() {
          markers = handler.addMarkers(<%= raw @hash.to_json %>);
          handler.bounds.extendWith(markers);
          handler.fitMapToBounds();
          if (markers.length == 0) {
          handler.getMap().setZoom(2);
        } else if (markers.length == 1) {
          handler.getMap().setZoom(14);
        }
        });
      });
    <% end %>
  <% end %>



<div style="width: 100%; height: 120px;" id="map" ></div>
